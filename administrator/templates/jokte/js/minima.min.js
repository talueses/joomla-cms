var MinimaClass=new Class({Implements:[Options],options:{},elements:{systemMessage:null,jformTitle:null},minima:null,initialize:function(a,b){this.minima=document.id(this.options.minima)||document.id("minima");this.setOptions(a);this.elements=b},showSystemMessage:function(){if(this.elements.systemMessage&&this.elements.systemMessage.getElement("ul li:last-child")){var b=this,a=new Element("a",{href:"#",id:"hide-system-message",html:"hide",events:{click:function(c){b.elements.systemMessage.dissolve({duration:"short"})}}});this.elements.systemMessage.show().getElement("ul li:last-child").adopt(a)}},dynamicTitle:function(){var b=this.minima.getElement(".pagetitle h2"),a=$("jform_alias"),c=this;if(this.elements.jformTitle.get("value")!=""){b.set("html",this.elements.jformTitle.get("value"))}this.elements.jformTitle.addEvent("keyup",function(d){if(c.elements.jformTitle.get("value")!=""){b.set("html",this.get("value"))}if(c.minima.hasClass("no-id")&&a){a.set("value",this.get("value").standardize().replace(/\s+/g,"-").replace(/[^-\w]+/g,"").toLowerCase())}})},makeRowsClickable:function(){var a=$$("input[name=checkall-toggle]");a.addEvent("click",function(){var b=$$(".adminlist tbody tr");b.toggleClass("selected")});$$(".adminlist tbody tr input[type=checkbox]").each(function(b){var c=b.getParent("tr"),d=$$("input[name=boxchecked]");b.addEvent("click",function(e){e&&e.stopPropagation();if(b.checked){c.addClass("selected")}else{c.removeClass("selected")}});c.addEvent("click",function(){if(b.checked){b.set("checked",false);d.set("value",0)}else{b.set("checked",true);d.set("value",1)}b.fireEvent("click")})});$$(".adminlist th img").getParent("th").addClass("active")}});var MinimaFilterBarClass=new Class({Implements:[Options],options:{},minima:null,filterStatusLabels:{"true":"Hide search & filters","false":"Show search & filters"},isActive:false,pageTitle:"",elements:{filterBar:null},filterSlide:null,filterAnchor:null,initialize:function(a,b,c){this.minima=$(this.options.minima)||$("minima");this.setOptions(a);this.elements=b;if(c.length){this.setLabelsLanguage(c.hideFilter,c.showFilter)}},setLabelsLanguage:function(b,a){if(b.length&&a.length){this.filterStatusLabels["true"]=b;this.filterStatusLabels["false"]=a}},createSlideElements:function(){var a=this;this.filterSlide=new Fx.Slide(this.elements.filterBar).hide();this.filterAnchor=new Element("a",{href:"#minima",id:"open-filter",html:a.filterStatusLabels["false"],events:{click:function(c){var b=$("filter_search");c.stop();a.filterSlide.toggle();this.toggleClass("active");if(this.hasClass("active")&&b){b.focus()}if($("content-top").hasClass("fixed")){window.scrollTo(0,0)}}}})},fixAnchor:function(){this.minima.getElement(".pagetitle").grab(this.filterAnchor)},onFilterSelected:function(){var a=this;filterBar.getElements("input, select").each(function(b){var c=b.get("value");if(c){a.isActive=true;a.pageTitle+=(b.get("tag").toLowerCase()=="select")?b.getElement("option:selected").get("html").toLowerCase()+" ":a.pageTitle+=c.toLowerCase()+" ";a.addFiltersToTitle()}})},addFiltersToTitle:function(){var a=minima.getElement(".pagetitle h2");if(this.pageTitle.length){a.set("html",a.get("html")+"<em>( "+this.pageTitle+")</em>")}},doFilterBar:function(){var a=this;this.createSlideElements();this.fixAnchor();this.onFilterSelected();if(this.isActive){this.filterSlide.show();this.filterAnchor.set("html",this.filterStatusLabels[this.filterSlide.open]).addClass("active")}this.filterSlide.addEvent("complete",function(){a.filterAnchor.set("html",a.filterStatusLabels[a.filterSlide.open])});this.elements.filterBar.show()}});var MinimaPanelClass=new Class({Implements:[Options],panelStatus:{"true":"active","false":"inactive"},panel:null,options:{prev:"",next:"",panelList:"",panelPage:"",panelWrapper:"",toIncrement:0,increment:900},minima:null,maxRightIncrement:null,panelSlide:null,numberOfExtensions:null,initialize:function(a){this.minima=document.id(this.options.minima)||document.id("minima");this.setOptions(a);this.panel=new Fx.Slide.Mine(this.options.panelWrapper,{mode:"vertical",transition:Fx.Transitions.Pow.easeOut}).hide();if(this.options.next){this.panelSlide=new Fx.Tween(this.options.panelList,{duration:500,transition:"back:in:out"});this.numberOfExtensions=this.options.panelList.getElements("li").length;this.options.panelList.setStyle("width",Math.ceil(this.numberOfExtensions/9)*this.options.increment);this.maxRightIncrement=-Math.ceil(this.options.panelPage.getChildren().length*this.options.increment-this.options.increment);this.showButtons()}},doPrevious:function(){if(this.options.toIncrement<0){this.options.next.show();this.options.toIncrement+=this.options.increment;this.panelSlide.pause();this.panelSlide.start("margin-left",this.options.toIncrement);this.options.panelPage.getFirst(".current").removeClass("current").getPrevious("li").addClass("current");this.showButtons()}},doNext:function(){if(this.options.toIncrement>this.maxRightIncrement){this.options.prev.show();this.options.toIncrement-=this.options.increment;this.panelSlide.pause();this.panelSlide.start("margin-left",this.options.toIncrement);this.options.panelPage.getFirst(".current").removeClass("current").getNext("li").addClass("current");this.showButtons()}},changeToPage:function(b){var a=b.id.substr("panel-pagination-".length);this.panelSlide.pause();this.options.toIncrement=Math.ceil(0-this.options.increment*a);this.panelSlide.start("margin-left",this.options.toIncrement);this.options.panelPage.getFirst(".current").removeClass("current");b.addClass("current");this.showButtons()},showButtons:function(){if(this.options.toIncrement==0){this.options.prev.hide()}else{this.options.prev.show()}if(this.options.toIncrement==this.maxRightIncrement){this.options.next.hide()}else{this.options.next.show()}}});var MinimaTabsClass=new Class({Implements:[Options],options:{},elements:{tabs:null,content:null},initialize:function(a,b){this.setOptions(a);this.elements=b},moveTabs:function(a){a.inject($("content"),"top")},showFirst:function(){this.elements.content.pick().removeClass("hide")},hideAllContent:function(){this.elements.content.addClass("hide")},addTabsAction:function(){var a=this;this.elements.tabs.each(function(c,b){c.addEvents({click:function(d){d.stop();a.elements.tabs.removeClass("active");a.elements.tabs[b].addClass("active");a.elements.content.addClass("hide");a.elements.content[b].removeClass("hide")}})})}});MinimaToolbarClass=new Class({Implements:[Options],options:{toolbar:$("toolbar"),toolbarElements:$$(".toolbar-list li a"),label:null},bulkActionsArray:new Array(),bulkNonActionsArray:new Array(),minima:null,initialize:function(a){this.minima=document.id(this.options.minima)||document.id("minima");this.setOptions(a)},doToolbar:function(){this.sortItems();this.fixToolbar()},sortItems:function(){var a=this;if(this.options.toolbarElements.length){this.options.toolbarElements.each(function(b){if(b.get("onclick")!=null&&b.get("onclick").contains("if")){a.bulkActionsArray.push(b.getParent("li"))}else{if(b.get("class")!="divider"){a.bulkNonActionsArray.push(b.getParent("li"))}}})}},fixToolbar:function(){var f=this;if(this.bulkActionsArray.length>1){var d=new Element("ul#actions").hide(),c=new Element("li",{id:"bulkActions",events:{click:function(g){this.toggleReveal(d,{duration:200,styles:["border"]});$$(f.minima.getElement("#bulkActions > a:first-child"),f).switchClass("active","inactive")},outerClick:function(){d.dissolve({duration:250});f.minima.getElement("#bulkActions > a:first-child").set("class","inactive")}}}),a=new Element("a[text= "+this.options.label+"]"),b=new Element("span.arrow");this.bulkActionsArray=this.bulkActionsArray.sort(function(h,g){if(h.get("text").toLowerCase()<g.get("text").toLowerCase()){return -1}if(h.get("text").toLowerCase()==g.get("text").toLowerCase()){return 0}return 1});this.bulkActionsArray.each(function(h,g){d.grab(h)});var e=($("toolbar-new"))?"ul > li#toolbar-new":"ul > li";c.inject($("toolbar").getElement(e),"after");c.adopt(a.grab(b),d)}}});var MinimaWidgetsClass=new Class({Implements:[Options],storage:null,options:{},minima:null,spinner:null,timeout:0,columns:{},boxes:{},initialize:function(){this.minima=document.id(this.options.minima)||document.id("minima");this.columns=this.minima.getElements(".col");if(this.columns.length){this.spinner=new Spinner(document.id("content-cpanel"));this.spinner.show(true);this.boxes=this.minima.getElements(".box");this.storage=new LocalStorage();this.loadPositions();this.attachDrag()}},addEvents:function(){var a=this;this.boxes.each(function(b){widgetId=b.id.replace("widget-","");b.getElement("a.nav-settings").addEvent("click",function(){a.settings(widgetId)});b.getElement("a.nav-hide").addEvent("click",function(){if(b.hasClass("expand")){b.removeClass("expand");b.addClass("minimize");this.set("text","Show")}else{if(b.hasClass("minimize")){b.removeClass("minimize");b.addClass("expand");this.set("text","Hide")}}})})},loadPositions:function(){widgets=this.storage.get("widgets");if(typeOf(widgets)=="array"&&widgets.length===0){this.storagePositions()}if(typeOf(widgets)=="array"){this.columns.each(function(c){widgets.each(function(e,d){if(e.position==c.id){if(e.id!=""){$(c.id).grab($(e.id))}}})})}else{var a=0;var b=this;$$(".box").each(function(d,c){b.columns[a].grab(d);a++;if(a>=b.columns.length){a=0}})}this.spinner.hide(true);this.displayWidgets()},displayWidgets:function(){this.boxes.each(function(b,a){setTimeout(function(){b.fade("in")},300*(a*1.5))})},storagePositions:function(){ordernation=new Array();this.columns.each(function(a){a.getElements(".box").each(function(d,c){var b={id:d.id,order:c,position:a.id};ordernation.push(b)})});this.storage.set("widgets",ordernation)},attachDrag:function(){var a=this;new Sortables(this.columns,{clone:true,handle:".box-top",opacity:0.6,revert:{duration:500,trasition:"elastic:out"},onStart:function(){minima.addClass("onDrag")},onComplete:function(b){minima.removeClass("onDrag");a.storagePositions()}})},settings:function(b){var a="index.php?option=com_modules&client_id=0&task=module.edit&id="+b+"&tmpl=component&view=module&layout=modal";SqueezeBox.open(a,{handler:"iframe",size:{x:900,y:550}})}});window.addEvent("domready",function(){var a=new MinimaWidgetsClass()});(function(){var c;var d=function(a){var b=$(a.target);var e=b.getParents();c.each(function(f){var h=f.element;if(h!=b&&!e.contains(h)){f.fn.call(h,a)}})};Element.Events.outerClick={onAdd:function(a){if(!c){document.addEvent("click",d);c=[]}c.push({element:this,fn:a})},onRemove:function(a){c=c.filter(function(b){return b.element!=this||b.fn!=a},this);if(!c.length){document.removeEvent("click",d);c=null}}}})();Element.implement("switchClass",function(e,d){var c=this.hasClass(e);this.removeClass(c?e:d).addClass(c?d:e);return this});$extend(Selectors.Pseudo,{visible:function(){if(this.getStyle("visibility")!="hidden"&&this.isVisible()&&this.isDisplayed()){return this}}});Element.implement("toggleReveal",function(b,a){return b.isDisplayed()?b.dissolve(a):b.reveal(a)});var ScrollSpy=new Class({Implements:[Options,Events],options:{container:window,max:0,min:0,mode:"vertical"},initialize:function(b){this.setOptions(b);this.container=document.id(this.options.container);this.enters=this.leaves=0;this.inside=false;this.listener=function(e){var a=this.container.getScroll(),f=a[this.options.mode=="vertical"?"y":"x"];if(f>=this.options.min&&(this.options.max==0||f<=this.options.max)){if(!this.inside){this.inside=true;this.enters++;this.fireEvent("enter",[a,this.enters,e])}this.fireEvent("tick",[a,this.inside,this.enters,this.leaves,e])}else{if(this.inside){this.inside=false;this.leaves++;this.fireEvent("leave",[a,this.leaves,e])}}this.fireEvent("scroll",[a,this.inside,this.enters,this.leaves,e])};this.addListener()},start:function(){this.container.addEvent("scroll",this.listener.bind(this))},stop:function(){this.container.removeEvent("scroll",this.listener.bind(this))},addListener:function(){this.start()}});window.addEvent("domready",function(){var h=MooTools.lang.get("Minima");contentTop=$("content-top"),toolbar=$("toolbar"),topHead=$("tophead"),minima=$("minima"),subMenu=$("submenu"),itemForm=$("item-form"),filterBar=$("filter-bar"),Minima=new MinimaClass({},{systemMessage:$("system-message"),jformTitle:$("jform_title")}),MinimaToolbar=new MinimaToolbarClass({toolbar:toolbar,toolbarElements:minima.getElements(".toolbar-list li a"),label:h.actionBtn}),MinimaFilterBar=new MinimaFilterBarClass({},{filterBar:filterBar},{hideFilter:h.hideFilter,showFilter:h.showFilter});new Fx.SmoothScroll({links:"#topLink"});if(filterBar){MinimaFilterBar.doFilterBar()}Minima.showSystemMessage();if($("jform_title")){Minima.dynamicTitle()}if(minima.getElements(".adminlist").length){Minima.makeRowsClickable()}MinimaToolbar.doToolbar();if(toolbar){toolbar.show()}if(subMenu&&itemForm){var d=new MinimaTabsClass({},{tabs:subMenu.getElements("a"),content:itemForm.getChildren("div")}),j=new MinimaTabsClass({},{tabs:minima.getElements(".vertical-tabs a"),content:$("tabs").getChildren(".panelform")});if(subMenu.hasClass("out")){d.moveTabs(subMenu)}d.hideAllContent();d.showFirst();d.addTabsAction();j.hideAllContent();j.showFirst();j.addTabsAction()}if(subMenu&&subMenu.hasClass("out")){subMenu.inject($("content"),"top")}var c=document.getScrollSize().y-document.getSize().y;new ScrollSpy({min:200,onEnter:function(){if(c>400){if(document.body.hasClass("locked")){contentTop.setStyle("left",(topHead.getSize().x-1140)/2)}contentTop.setStyle("width",topHead.getSize().x-40).addClass("fixed")}},onLeave:function(){if(c>400){contentTop.removeClass("fixed");if(document.body.hasClass("locked")){contentTop.setStyle("width","100%")}}}});var k=$("panel-wrapper"),f=$("more");extraLists=$("list-content"),openPanel=$("panel-tab"),listWrapper=$("list-wrapper");if(k){Fx.Slide.Mine=new Class({Extends:Fx.Slide,initialize:function(m,l){this.parent(m,l);this.wrapper=this.element.getParent()}});var b=$("panel-pagination"),e=$("prev"),g=$("next");var i=new MinimaPanelClass({panelWrapper:k,prev:e,next:g,panelList:$("panel-list"),panelPage:b});e.addEvent("click",function(){i.doPrevious()});g.addEvent("click",function(){i.doNext()});b.getChildren("li").addEvent("click",function(){i.changeToPage(this)});openPanel.addEvents({click:function(){minima.getElements("#shortcuts .parent").removeClass("hover");i.panel.toggle()}});i.panel.addEvent("complete",function(){openPanel.set("class",i.panelStatus[i.panel.open])});minima.getElements("#panel-list li").addEvent("click",function(){i.panel.toggle()})}if(f){f.addEvent("click",function(){this.switchClass("active","inactive");this.toggleReveal(extraLists,{heightOverride:"155",duration:250})})}var a=function(){f.set("class","inactive");listWrapper.removeClass("active");extraLists.dissolve()};if(listWrapper){listWrapper.addEvent("outerClick",function(){a()})}if(extraLists){extraLists.getElements("a").addEvent("click",function(){a()})}minima.getElements("#shortcuts .parent").each(function(l){l.addEvents({click:function(){this.toggleReveal(this.getChildren(".sub")[0]).toggleClass("hover");this.getElement("a").toggleClass("hover")},outerClick:function(){this.getChildren(".sub").dissolve({duration:200}).removeClass("hover");this.getElement("a").removeClass("hover")}})})});